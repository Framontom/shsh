# API 文档

实现项目：在线通信系统 组长：段睿思  组员：宋建昊、李晔


## （一）用户管理模块

#### 用户注册

POST	/register

目的：用户注册

请求参数：

|     名称     | 位置 | 类型   | 必选 | 说明                                               |
| :-----------: | :--- | ------ | ---- | -------------------------------------------------- |
|   userName   | body | string | yes  | 用户名                                             |
|   password   | body | string | yes  | 密码                                               |
| phone_number | body | string | yes  | 电话号码                                           |
| email_address | body | string | yes  | 邮箱地址                                           |
|   image_id   | body | int    | yes  | 头像 id（本app不支持上传头像，仅支持选择已有头像） |
|   self_sign   | body | string | yes  | 个性签名                                           |

返回结果：

| 状态码 | code | info         | 说明                   |
| ------ | ---- | ------------ | ---------------------- |
| 200    | 0    | 注册成功     | 成功注册               |
| 401    | 2    | 该用户已存在 | 注册使用用户名已被使用 |

返回数据结构：

| 名称  | 类型   | 必选 | 说明       |
| ----- | ------ | ---- | ---------- |
| token | string | yes  | 签发的令牌 |

#### 用户注销

POST	/delete

目的：用户注销

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明   |
| :------: | ---- | ------ | ---- | ------ |
| username | body | string | ok   | 用户名 |
| password | body | string | ok   | 密码   |

返回结果：

| 状态码 | code | info           | 说明                   |
| ------ | ---- | -------------- | ---------------------- |
| 200    | 0    | 注销成功       | 成功注销用户           |
| 405    | 2    | bad method     | 请求不是 POST          |
| 405    | 2    | wrong username | 用户名不存在           |
| 405    | 2    | wrong password | 该用户名对应的密码错误 |

返回数据结构：无

#### 用户登录

POST	/login

目的：用户登录

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明   |
| :------: | ---- | ------ | ---- | ------ |
| username | body | string | ok   | 用户名 |
| password | body | string | ok   | 密码   |

返回结果：

| 状态码 | code | info                             | 说明                   |
| ------ | ---- | -------------------------------- | ---------------------- |
| 200    | 0    | 登录成功                         | 登陆成功               |
| 405    | 2    | bad method                       | 请求不是 POST          |
| 401    | 2    | No user named {username} existed | 用户名不存在           |
| 401    | 2    | wrong password                   | 该用户名对应的密码错误 |

返回数据结构：

| 名称      | 类型   | 必选 | 说明         |
| --------- | ------ | ---- | ------------ |
| token     | string | yes  | 签发的令牌   |
| image_id  | int    | yes  | 用户头像     |
| email     | string | yes  | 用户电子邮箱 |
| phonenum  | string | yes  | 用户电话号码 |
| self_sign | string | yes  | 用户个性签名 |

#### 用户退出

不需要进行前后端交互，只需要重置前端 store 的信息，并跳转到最初页面即可。

#### 用户信息编辑

POST	/reset

目的：用户修改个人信息

请求参数：

|     名称     | 位置 | 类型   | 必选 | 说明                                                 |
| :-----------: | :--- | ------ | ---- | ---------------------------------------------------- |
|   userName   | body | string | yes  | 新用户名                                             |
|   password   | body | string | yes  | 新密码                                               |
| phone_number | body | string | yes  | 新电话号码                                           |
| email_address | body | string | yes  | 新邮箱地址                                           |
|   image_id   | body | int    | yes  | 新头像 id（本app不支持上传头像，仅支持选择已有头像） |
|   self_sign   | body | string | yes  | 新个性签名                                           |
|  oldUsername  | body | string | yes  | 老用户名                                             |
|  oldPassword  | body | string | yes  | 老密码                                               |

返回结果：

| 状态码 | code | info                             | 说明                   |
| ------ | ---- | -------------------------------- | ---------------------- |
| 200    | 0    | 修改成功                         | 修改成功               |
| 405    | 2    | bad method                       | 请求不是 POST          |
| 404    | 3    | No user named {username} existed | 用户名不存在           |
| 401    | 2    | wrong password                   | 该用户名对应的密码错误 |

返回数据结构：

| 名称  | 类型   | 必选 | 说明       |
| ----- | ------ | ---- | ---------- |
| token | string | yes  | 签发的令牌 |

#### 用户名搜索

POST	/search

目的：通过用户名来搜索用户

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明         |
| :------: | :--- | ------ | ---- | ------------ |
| username | body | string | yes  | 搜索的用户名 |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 修改成功   | 修改成功      |
| 405    | 2    | bad method | 请求不是 POST |

返回数据结构：

| 名称     | 类型   | 必选 | 说明                                           |
| -------- | ------ | ---- | ---------------------------------------------- |
| num      | int    | yes  | 搜索到的结果数量，0则查无此人，1则显示后续信息 |
| imageId  | int    | no   | 搜索到的用户的头像id                           |
| name     | string | no   | 搜索到的用户名称                               |
| selfSign | string | no   | 搜索到的用户的个性签名                         |

#### 用户主页信息

POST	/check

目的：查看某用户用户主页的信息

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明               |
| :------: | :--- | ------ | ---- | ------------------ |
| username | body | string | yes  | 查看的用户的用户名 |

返回结果：

| 状态码 | code | info                             | 说明          |
| ------ | ---- | -------------------------------- | ------------- |
| 200    | 0    | 修改成功                         | 修改成功      |
| 405    | 2    | bad method                       | 请求不是 POST |
| 401    | 2    | No user named {username} existed | 该用户不存在  |

返回数据结构：

| 名称      | 类型   | 必选 | 说明         |
| --------- | ------ | ---- | ------------ |
| username  | string | yes  | 用户名称     |
| image_id  | int    | yes  | 用户头像     |
| email     | string | yes  | 用户电子邮箱 |
| phonenum  | string | yes  | 用户电话号码 |
| self_sign | string | yes  | 用户个性签名 |

#### 好友申请操作

POST	/addFriend

请求参数：

| 名称 | 位置 | 类型   | 必选 | 说明             |
| :--: | :--- | ------ | ---- | ---------------- |
| from | body | string | yes  | 申请人的用户名   |
|  to  | body | string | yes  | 被申请人的用户名 |

返回结果：

| 状态码 | code | info       | 说明                     |
| ------ | ---- | ---------- | ------------------------ |
| 200    | 0    | 修改成功   | 修改成功                 |
| 405    | 2    | bad method | 请求不是 POST            |
| 401    | 2    | 用户不存在 | from或to对应的用户不存在 |

返回数据结构：无

#### 好友申请列表

POST	/getftp

目的：查看没有被通过的好友申请

请求参数：

| 名称 | 位置 | 类型   | 必选 | 说明   |
| :--: | :--- | ------ | ---- | ------ |
| name | body | string | yes  | 用户名 |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 401    | 2    | 用户不存在 | 该用户不存在  |

返回数据结构：

| 名称     | 类型       | 必选 | 说明                         |
| -------- | ---------- | ---- | ---------------------------- |
| namelist | string列表 | yes  | 未通过申请的用户的名称列表   |
| idlist   | int列表    | yes  | 未通过申请的用户的头像id列表 |

#### 待通过好友申请列表

POST	/getrtp

目的：查看别人对你的申请

请求参数：

| 名称 | 位置 | 类型   | 必选 | 说明   |
| :--: | :--- | ------ | ---- | ------ |
| name | body | string | yes  | 用户名 |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 401    | 2    | 用户不存在 | 该用户不存在  |

返回数据结构：

| 名称     | 类型       | 必选 | 说明                           |
| -------- | ---------- | ---- | ------------------------------ |
| namelist | string列表 | yes  | 申请加你好友的用户的名称列表   |
| idlist   | int列表    | yes  | 申请加你好友的用户的头像id列表 |

需要注意的是这两个列表中下标相同的项对应同一个用户

#### 通过好友申请

POST	/addfriend

目的：通过好友申请

请求参数：

| 名称 | 位置 | 类型   | 必选 | 说明             |
| :--: | :--- | ------ | ---- | ---------------- |
| from | body | string | yes  | 申请人的用户名   |
|  to  | body | string | yes  | 被申请人的用户名 |

返回结果：

| 状态码 | code | info       | 说明                     |
| ------ | ---- | ---------- | ------------------------ |
| 200    | 0    | 修改成功   | 修改成功                 |
| 405    | 2    | bad method | 请求不是 POST            |
| 401    | 2    | 用户不存在 | from或to对应的用户不存在 |

返回数据结构：无

#### 好友删除

POST	/delfriend

目的：删除好友

请求参数：

| 名称 | 位置 | 类型   | 必选 | 说明             |
| :--: | :--- | ------ | ---- | ---------------- |
| from | body | string | yes  | 申请人的用户名   |
|  to  | body | string | yes  | 被申请人的用户名 |

返回结果：

| 状态码 | code | info       | 说明                     |
| ------ | ---- | ---------- | ------------------------ |
| 200    | 0    | 修改成功   | 修改成功                 |
| 405    | 2    | bad method | 请求不是 POST            |
| 401    | 2    | 用户不存在 | from或to对应的用户不存在 |

返回数据结构：无

#### 好友列表

POST	/friendlist

目的：获取好友列表

请求参数：

| 名称 | 位置 | 类型   | 必选 | 说明   |
| :--: | :--- | ------ | ---- | ------ |
| name | body | string | yes  | 用户名 |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 401    | 2    | 用户不存在 | 该用户不存在  |

返回数据结构：

| 名称     | 类型       | 必选 | 说明             |
| -------- | ---------- | ---- | ---------------- |
| namelist | string列表 | yes  | 好友的名称列表   |
| idlist   | int列表    | yes  | 好友的头像id列表 |

需要注意的是这两个列表中下标相同的项对应同一个用户

POST	/getfriendlist

目的：获取好友列表（会用在不止一个地方，因为创建群聊、好友分组也需要获取好友列表）

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明   |
| :------: | :--- | ------ | ---- | ------ |
| username | body | string | yes  | 用户名 |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 401    | 2    | 用户不存在 | 该用户不存在  |

返回数据结构：

| 名称       | 类型       | 必选 | 说明             |
| ---------- | ---------- | ---- | ---------------- |
| friendlist | string列表 | yes  | 好友的名称列表   |
| idlist     | int列表    | yes  | 好友的头像id列表 |

需要注意的是这两个列表中下标相同的项对应同一个用户

#### 查看好友分组列表

POST	/ggfl

目的：获取好友分组列表

请求参数：

| 名称 | 位置 | 类型   | 必选 | 说明   |
| :--: | :--- | ------ | ---- | ------ |
| name | body | string | yes  | 用户名 |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 402    | 2    | 用户不存在 | 该用户不存在  |

返回数据结构：

| 名称      | 类型            | 必选 | 说明             |
| --------- | --------------- | ---- | ---------------- |
| namelist  | string 二维数组 | yes  | 好友的名称列表   |
| idlist    | int 二维数组    | yes  | 好友的头像id列表 |
| grouplist | string 数组     | yes  | 好友分组的列表   |

说明：

第 i 个好友分组的组名为 grouplist[i] 对应的分组组员的名字的列表为 namelist[i] 头像 id 列表为 idlist[i]

#### 新增好友分组

POST	/agfl

目的：申请新增一个好友分组

请求参数：

|   名称   | 位置 | 类型        | 必选 | 说明             |
| :-------: | :--- | ----------- | ---- | ---------------- |
|   name   | body | string      | yes  | 用户名           |
| groupname | body | string      | yes  | 分组组名         |
|   group   | body | string 数组 | yes  | 分组对应组员名单 |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 402    | 2    | 用户不存在 | 该用户不存在  |

返回数据结构：无

#### 删除好友分组

POST	/delgroup

目的：删除一个好友分组

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明     |
| :-------: | :--- | ------ | ---- | -------- |
|   name   | body | string | yes  | 用户名   |
| groupname | body | string | yes  | 分组组名 |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 401    | 2    | 用户不存在 | 该用户不存在  |

返回数据结构：无

### （二）会话模块私聊部分

#### 私聊发送信息

POST	/sendsingle

目的：向某个好友发送信息

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明                                            |
| :------: | :--- | ------ | ---- | ----------------------------------------------- |
|   from   | body | string | yes  | 发送者用户名                                    |
|    to    | body | string | yes  | 接收者用户名                                    |
| sendtime | body | string | yes  | 发送时间                                        |
|   text   | body | string | yes  | 发送内容                                        |
| isreply | body | string | no   | 如果有，则是回复的信息的 sendtime，不回复时置空 |

返回结果：

| 状态码 | code | info           | 说明                 |
| ------ | ---- | -------------- | -------------------- |
| 200    | 0    | 无             | 获取成功             |
| 405    | 2    | bad method     | 请求不是 POST        |
| 401    | 2    | 用户不存在     | 发送或接收的人不存在 |
| 402    | 1    | 你不是他的好友 | 二者并非好友         |

返回数据结构：无

#### 私聊获取历史记录

POST	/history

目的：获取与某一人聊天的全部历史记录，并在检测到对方发信息的时候用于更新记录

请求参数：

| 名称 | 位置 | 类型   | 必选 | 说明         |
| :--: | :--- | ------ | ---- | ------------ |
| from | body | string | yes  | 发送者用户名 |
|  to  | body | string | yes  | 接收者用户名 |

返回结果：

| 状态码 | code | info           | 说明                 |
| ------ | ---- | -------------- | -------------------- |
| 200    | 0    | 无             | 获取成功             |
| 405    | 2    | bad method     | 请求不是 POST        |
| 404    | 2    | 用户不存在     | 发送或接收的人不存在 |
| 402    | 1    | 你不是他的好友 | 二者并非好友         |

返回数据结构：

| 名称       | 类型        | 必选 | 说明                                              |
| ---------- | ----------- | ---- | ------------------------------------------------- |
| imageId    | int 数组    | yes  | 消息发送者的头像组成的列表                        |
| text       | string 数组 | yes  | 发送消息的内容的列表                              |
| sender     | string 数组 | yes  | 发送消息的人的列表                                |
| reader     | string 数组 | yes  | 读消息的人的列表                                  |
| sendtime   | string 数组 | yes  | 发送时间的列表                                    |
| isReply    | bool 数组   | yes  | 消息是否回复某条消息的列表                        |
| replyTo    | string 数组 | yes  | （假设回复了某条消息）该消息回复的消息的 sendtime |
| replyCount | int 数组    | yes  | 该条消息被多少个人回复了                          |

说明：第i条消息的信息由以上这些数组的第i项共同组成

#### 实时接收消息

POST	/update

目的：本软件采用轮询的方式来实时获取方式，该函数会每0.4秒触发一次来询问是否在该会话界面下有消息更新

请求参数：

| 名称 | 位置 | 类型   | 必选 | 说明                 |
| :--: | :--- | ------ | ---- | -------------------- |
| from | body | string | yes  | 使用者用户名         |
|  to  | body | string | yes  | 当前会话对方的用户名 |

返回结果：

| 状态码 | code | info       | 说明                               |
| ------ | ---- | ---------- | ---------------------------------- |
| 200    | 0    | 无         | 获取成功                           |
| 404    | 2    | bad method | 没有该用户（该情况基本不可能出现） |

返回数据结构：

| 名称 | 类型 | 必选 | 说明                                                                  |
| ---- | ---- | ---- | --------------------------------------------------------------------- |
| num  | int  | yes  | 当前未读消息数量，如果是0则不需要重新接收信息，反之则需要重新获取信息 |

#### 私聊未读计数

该部分与群聊未读计数统一在会话综合功能部分展示

#### 私聊筛选记录

POST	/searchsingle

目的：在私聊中通过用户或发送时间来筛选聊天记录

请求参数：

|  名称  | 位置 | 类型   | 必选 | 说明                                                               |
| :-----: | :--- | ------ | ---- | ------------------------------------------------------------------ |
|  from  | body | string | yes  | 发送者用户名                                                       |
|   to   | body | string | yes  | 接收者用户名                                                       |
|   key   | body | int    | yes  | 具体是用什么来进行筛选，是1则通过时间筛选，不是1则通过发送用户筛选 |
| content | body | string | yes  | 具体搜索内容是什么                                                 |

返回结果：

| 状态码 | code | info           | 说明                 |
| ------ | ---- | -------------- | -------------------- |
| 200    | 0    | 无             | 获取成功             |
| 405    | 2    | bad method     | 请求不是 POST        |
| 404    | 2    | 用户不存在     | 发送或接收的人不存在 |
| 402    | 1    | 你不是他的好友 | 二者并非好友         |

返回数据结构：

| 名称       | 类型        | 必选 | 说明                                              |
| ---------- | ----------- | ---- | ------------------------------------------------- |
| imageId    | int 数组    | yes  | 消息发送者的头像组成的列表                        |
| text       | string 数组 | yes  | 发送消息的内容的列表                              |
| sender     | string 数组 | yes  | 发送消息的人的列表                                |
| reader     | string 数组 | yes  | 读消息的人的列表                                  |
| sendtime   | string 数组 | yes  | 发送时间的列表                                    |
| isReply    | bool 数组   | yes  | 消息是否回复某条消息的列表                        |
| replyTo    | string 数组 | yes  | （假设回复了某条消息）该消息回复的消息的 sendtime |
| replyCount | int 数组    | yes  | 该条消息被多少个人回复了                          |

说明：这些数组仅仅包含筛选出来的信息的各种信息

#### 私聊删除记录

POST	/deletesingle

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明                                         |
| :------: | :--- | ------ | ---- | -------------------------------------------- |
|   from   | body | string | yes  | 发送者用户名                                 |
|    to    | body | string | yes  | 接收者用户名                                 |
| sendtime | body | string | yes  | 要删除的这条消息的发送时间，用于找到这条消息 |

返回结果：

| 状态码 | code | info       | 说明                                 |
| ------ | ---- | ---------- | ------------------------------------ |
| 200    | 0    | 无         | 获取成功                             |
| 405    | 2    | bad method | 请求不是 POST                        |
| 404    | 2    | 消息不存在 | 要删除的消息不存在（基本不可能发生） |

返回数据结构：无

### （三）会话模块群聊部分

#### 群聊发送信息

POST	/groupsendsingle

目的：向某个群聊发送信息

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明                                            |
| :------: | :--- | ------ | ---- | ----------------------------------------------- |
|   from   | body | string | yes  | 发送者用户名                                    |
|    to    | body | string | yes  | 组名                                            |
| sendtime | body | string | yes  | 发送时间                                        |
|   text   | body | string | yes  | 发送内容                                        |
| isreply | body | string | no   | 如果有，则是回复的信息的 sendtime，不回复时置空 |

返回结果：

| 状态码 | code | info       | 说明           |
| ------ | ---- | ---------- | -------------- |
| 200    | 0    | 无         | 获取成功       |
| 405    | 2    | bad method | 请求不是 POST  |
| 401    | 2    | 用户不存在 | 发送的人不存在 |
| 402    | 1    | 你不是成员 | 你被踢了       |

返回数据结构：无

#### 群聊获取历史记录

POST	/grouphistory

目的：获取在某一个群聊中的的全部历史记录，并在检测到对方发信息的时候用于更新记录

请求参数：

| 名称 | 位置 | 类型   | 必选 | 说明         |
| :--: | :--- | ------ | ---- | ------------ |
| from | body | string | yes  | 发送者用户名 |
|  to  | body | string | yes  | 组名         |

返回结果：

| 状态码 | code | info       | 说明                 |
| ------ | ---- | ---------- | -------------------- |
| 200    | 0    | 无         | 获取成功             |
| 405    | 2    | bad method | 请求不是 POST        |
| 404    | 2    | 用户不存在 | 发送或接收的人不存在 |
| 402    | 1    | 你不是成员 | 你被踢了             |

返回数据结构：

| 名称       | 类型        | 必选 | 说明                                              |
| ---------- | ----------- | ---- | ------------------------------------------------- |
| imageId    | int 数组    | yes  | 消息发送者的头像组成的列表                        |
| text       | string 数组 | yes  | 发送消息的内容的列表                              |
| sender     | string 数组 | yes  | 发送消息的人的列表                                |
| reader     | string 数组 | yes  | 读消息的人的列表                                  |
| sendtime   | string 数组 | yes  | 发送时间的列表                                    |
| isReply    | bool 数组   | yes  | 消息是否回复某条消息的列表                        |
| replyTo    | string 数组 | yes  | （假设回复了某条消息）该消息回复的消息的 sendtime |
| replyCount | int 数组    | yes  | 该条消息被多少个人回复了                          |

说明：第i条消息的信息由以上这些数组的第i项共同组成

#### 实时接收消息

POST	/groupupdate

目的：本软件采用轮询的方式来实时获取方式，该函数会每0.4秒触发一次来询问是否在该会话界面下有消息更新

请求参数：

| 名称 | 位置 | 类型   | 必选 | 说明         |
| :--: | :--- | ------ | ---- | ------------ |
| from | body | string | yes  | 使用者用户名 |
|  to  | body | string | yes  | 群聊名称     |

返回结果：

| 状态码 | code | info       | 说明                               |
| ------ | ---- | ---------- | ---------------------------------- |
| 200    | 0    | 无         | 获取成功                           |
| 404    | 2    | bad method | 没有该用户（该情况基本不可能出现） |

返回数据结构：

| 名称 | 类型 | 必选 | 说明                                                                  |
| ---- | ---- | ---- | --------------------------------------------------------------------- |
| num  | int  | yes  | 当前未读消息数量，如果是0则不需要重新接收信息，反之则需要重新获取信息 |

#### 群聊未读计数

该部分与群聊未读计数统一在会话综合功能部分展示

#### 群聊筛选记录

POST	/groupsearchsingle

目的：在群聊中通过发送用户或时间来筛选聊天记录

请求参数：

|  名称  | 位置 | 类型   | 必选 | 说明                                                               |
| :-----: | :--- | ------ | ---- | ------------------------------------------------------------------ |
|  from  | body | string | yes  | 发送者用户名                                                       |
|   to   | body | string | yes  | 群名                                                               |
|   key   | body | int    | yes  | 具体是用什么来进行筛选，是1则通过时间筛选，不是1则通过发送用户筛选 |
| content | body | string | yes  | 具体搜索内容是什么                                                 |

返回结果：

| 状态码 | code | info         | 说明                   |
| ------ | ---- | ------------ | ---------------------- |
| 200    | 0    | 无           | 获取成功               |
| 405    | 2    | bad method   | 请求不是 POST          |
| 404    | 2    | 用户不存在   | 发送或接收的群聊不存在 |
| 402    | 1    | 你不是群成员 | 你不是群成员           |

返回数据结构：

| 名称       | 类型        | 必选 | 说明                                              |
| ---------- | ----------- | ---- | ------------------------------------------------- |
| imageId    | int 数组    | yes  | 消息发送者的头像组成的列表                        |
| text       | string 数组 | yes  | 发送消息的内容的列表                              |
| sender     | string 数组 | yes  | 发送消息的人的列表                                |
| reader     | string 数组 | yes  | 读消息的人的列表                                  |
| sendtime   | string 数组 | yes  | 发送时间的列表                                    |
| isReply    | bool 数组   | yes  | 消息是否回复某条消息的列表                        |
| replyTo    | string 数组 | yes  | （假设回复了某条消息）该消息回复的消息的 sendtime |
| replyCount | int 数组    | yes  | 该条消息被多少个人回复了                          |

说明：这些数组仅仅包含筛选出来的信息的各种信息

#### 群聊删除记录

POST	/groupdeletesingle

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明                                         |
| :------: | :--- | ------ | ---- | -------------------------------------------- |
|   from   | body | string | yes  | 发送者用户名                                 |
|    to    | body | string | yes  | 群名                                         |
| sendtime | body | string | yes  | 要删除的这条消息的发送时间，用于找到这条消息 |

返回结果：

| 状态码 | code | info       | 说明                                 |
| ------ | ---- | ---------- | ------------------------------------ |
| 200    | 0    | 无         | 获取成功                             |
| 405    | 2    | bad method | 请求不是 POST                        |
| 404    | 2    | 消息不存在 | 要删除的消息不存在（基本不可能发生） |

返回数据结构：无

### （四）综合会话部分

#### 会话列表

POST	/getchatlist

目的：获得会话列表以及未读计数，私聊和群聊均需包含

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明   |
| :------: | :--- | ------ | ---- | ------ |
| username | body | string | yes  | 用户名 |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 401    | 2    | 用户不存在 | 该用户不存在  |

返回数据结构：

| 名称          | 类型       | 必选 | 说明               |
| ------------- | ---------- | ---- | ------------------ |
| namelist      | string列表 | yes  | 会话的名称列表     |
| idlist        | int列表    | yes  | 会话的头像id列表   |
| unreadnumlist | int列表    | yes  | 会话的未读计数列表 |

### （五）群聊管理部分

#### 群聊创建

POST	/addgroup

目的：创建一个群聊

请求参数：

|   名称   | 位置 | 类型        | 必选 | 说明           |
| :-------: | :--- | ----------- | ---- | -------------- |
|   name   | body | string      | yes  | 创建者用户名   |
| groupname | body | string      | yes  | 群名           |
|   group   | body | string 数组 | yes  | 群成员名称列表 |

返回结果：

| 状态码 | code | info         | 说明             |
| ------ | ---- | ------------ | ---------------- |
| 200    | 0    | 无           | 获取成功         |
| 405    | 2    | bad method   | 请求不是 POST    |
| 402    | 2    | 用户不存在   | 某一个用户不存在 |
| 401    | 2    | 群聊名被占用 | 群聊名被占用     |

返回数据结构：无

#### 群聊信息展示

POST	/groupinfo

目的：获取当前群聊信息

请求参数：

| 名称 | 位置 | 类型   | 必选 | 说明   |
| :---: | :--- | ------ | ---- | ------ |
| name | body | string | yes  | 用户名 |
| gname | body | string | yes  | 组名   |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 402    | 2    | 用户不存在 | 该用户不存在  |
| 401    | 2    | 群聊不存在 | 群聊不存在    |

返回数据结构：

| 名称         | 类型       | 必选 | 说明                                      |
| ------------ | ---------- | ---- | ----------------------------------------- |
| memberlist   | string列表 | yes  | 群聊成员名字列表                          |
| idlist       | int列表    | yes  | 群聊成员的头像id列表                      |
| identitylist | int列表    | yes  | 群聊成员的身份列表，群员0，管理员1，群主2 |
| power        | int        | yes  | 该成员的权利，群管理员为1，其他的为0      |
| gonggao      | string     | yes  | 群公告                                    |
| qunzhu       | string     | yes  | 群主的名称                                |

#### 管理员任免

任：

POST	/managemember

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明           |
| :-------: | :--- | ------ | ---- | -------------- |
|   from   | body | string | yes  | 发送者用户名   |
|    to    | body | string | yes  | 被晋升者用户名 |
| groupname | body | string | yes  | 组名           |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 404    | 2    | 群聊不存在 | 用户被踢出    |

返回数据结构：无

说明：前端已经保证不会出现权限不足的问题

免

POST	/bamian

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明           |
| :-------: | :--- | ------ | ---- | -------------- |
|   from   | body | string | yes  | 发送者用户名   |
|    to    | body | string | yes  | 被罢免者用户名 |
| groupname | body | string | yes  | 组名           |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 404    | 2    | 群聊不存在 | 用户被踢出    |

返回数据结构：无

说明：前端已经保证不会出现权限不足的问题

#### 群主转让

POST	/changeleader

目的：群主转让

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明           |
| :-------: | :--- | ------ | ---- | -------------- |
|   from   | body | string | yes  | 发送者用户名   |
|    to    | body | string | yes  | 被罢免者用户名 |
| groupname | body | string | yes  | 组名           |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 404    | 2    | 群聊不存在 | 用户被踢出    |

返回数据结构：无

说明：前端已经保证不会出现权限不足的问题

#### 移除群员

POST	/removemember

目的：踢出群员

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明           |
| :-------: | :--- | ------ | ---- | -------------- |
|   from   | body | string | yes  | 发送者用户名   |
|    to    | body | string | yes  | 被罢免者用户名 |
| groupname | body | string | yes  | 组名           |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 404    | 2    | 群聊不存在 | 用户被踢出    |

返回数据结构：无

说明：前端已经保证不会出现权限不足的问题

#### 编辑群公告

POST	/updatestate

目的：编辑新的群公告

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明     |
| :-------: | :--- | ------ | ---- | -------- |
|   text   | body | string | yes  | 公告内容 |
| groupname | body | string | yes  | 群名     |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 404    | 2    | 群聊不存在 | 用户被踢出    |

返回数据结构：无

说明：前端已经保证不会出现权限不足的问题。

群公告不会覆盖历史群公告

#### 邀请成员

POST	/invite

目的：对某几个成员发出邀请进群

请求参数：

|   名称   | 位置 | 类型        | 必选 | 说明             |
| :-------: | :--- | ----------- | ---- | ---------------- |
|   name   | body | string      | yes  | 邀请者用户名     |
| groupname | body | string      | yes  | 群名             |
|   group   | body | string 数组 | yes  | 邀请成员名称列表 |
|  content  | body | string      | yes  | 邀请原因         |

返回结果：

| 状态码 | code | info       | 说明             |
| ------ | ---- | ---------- | ---------------- |
| 200    | 0    | 无         | 获取成功         |
| 405    | 2    | bad method | 请求不是 POST    |
| 402    | 2    | 用户不存在 | 某一个用户不存在 |

返回数据结构：无

说明：仅仅加入审核列表，并不直接让其进群

#### 获取审核列表

POST	/shenhelist

目的：获取审核列表

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明 |
| :-------: | :--- | ------ | ---- | ---- |
| groupname | body | string | yes  | 群名 |

返回结果：

| 状态码 | code | info       | 说明          |
| ------ | ---- | ---------- | ------------- |
| 200    | 0    | 无         | 获取成功      |
| 405    | 2    | bad method | 请求不是 POST |
| 401    | 2    | 用户不存在 | 该用户不存在  |

返回数据结构：

| 名称     | 类型       | 必选 | 说明                         |
| -------- | ---------- | ---- | ---------------------------- |
| namelist | string列表 | yes  | 未通过审核的用户的名称列表   |
| idlist   | int列表    | yes  | 未通过审核的用户的头像id列表 |
| infolist | string列表 | yes  | 申请原因列表                 |

#### 通过部分成员邀请的审核

POST	/tongguo

目的：同标题

请求参数：

|   名称   | 位置 | 类型        | 必选 | 说明                 |
| :-------: | :--- | ----------- | ---- | -------------------- |
|   name   | body | string      | yes  | 审核人用户名         |
| groupname | body | string      | yes  | 群名                 |
|   group   | body | string 数组 | yes  | 审核通过成员名称列表 |
|  content  | body | string      | yes  | 通过原因             |

返回结果：

| 状态码 | code | info       | 说明             |
| ------ | ---- | ---------- | ---------------- |
| 200    | 0    | 无         | 获取成功         |
| 405    | 2    | bad method | 请求不是 POST    |
| 402    | 2    | 用户不存在 | 某一个用户不存在 |

返回数据结构：无

#### 退出群聊

目的：同标题

请求参数：

|   名称   | 位置 | 类型   | 必选 | 说明         |
| :-------: | :--- | ------ | ---- | ------------ |
|   name   | body | string | yes  | 审核人用户名 |
| groupname | body | string | yes  | 群名         |

返回结果：

| 状态码 | code | info       | 说明             |
| ------ | ---- | ---------- | ---------------- |
| 200    | 0    | 无         | 获取成功         |
| 405    | 2    | bad method | 请求不是 POST    |
| 402    | 2    | 用户不存在 | 某一个用户不存在 |

返回数据结构：无
